<!DOCTYPE html>
<html lang="da" xmlns:th="http://www.thymeleaf.org">
<head>

  <meta charset="UTF-8">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/stylesheet.css">
  <title>Fleet</title>
</head>
<body>
<div th:replace="~{fragments/header :: header('dataRegistration')}"></div>

<div class="page-container">

<h1>Fleet</h1>
</div>


  <meta charset="UTF-8" />
  <title>Flåde Oversigt</title>
  <link rel="stylesheet" href="/stylesheet.css" /> <!-- Sørg for stien er korrekt -->
  <!-- Font links -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
          href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:ital,wght@0,200..800;1,200..800&display=swap"
          rel="stylesheet"
  />
</head>
<body>
<!-- Opdateret 'activeMenu' parameter til at matche en mulig 'fleet' menu item -->
<div th:replace="~{fragments/header :: header('fleet')}"></div>

<div class="container">
  <div class="header-flex">
    <h1>Fleet Oversigt</h1>
  </div>
  <p class="description-text">
    På denne side kan du se oversigten over vores fleet, tilføje biler,
    redigere deres info & status eller helt slette dem.
  </p>

  <div class="action-section">
    <div class="create-car-section">
      <!-- Peger på CarController's createCar mapping -->
      <button type="button" class="btn-opret"
              th:onclick="|location.href='@{/dataRegistration/createCar}'|">
        Opret bil
      </button>
      <p>Klik her for at oprette ny bil</p>
    </div>
    <div class="search-id-container">
      <div class="search-id-section">
        <input type="text" id="searchCarId" name="searchCarId" placeholder="Indtast bilens ID nummer" />
        <button type="button" class="btn-soeg">Søg</button> <!-- Søgefunktionalitet skal implementeres -->
      </div>
      <p>Find en bil med dens ID nummer</p>
    </div>
  </div>

  <!-- Filter Formular peger nu på FleetController -->
  <form class="filter-section" th:action="@{/fleet/overview}" method="get">
    <!-- Brand Filter -->
    <div class="filter-group">
      <select id="brandFilter" name="brand"> <!-- 'name' bruges til @RequestParam i controlleren -->
        <option value="">Brand</option>
        <!-- Antager 'availableBrands' er en liste af Brand DTO/Model objekter -->
        <option th:each="brandObj : ${availableBrands}"
                th:value="${brandObj.brandId}"
                th:text="${brandObj.brandName}">
        </option>
      </select>
    </div>

    <!-- Status Filter (bruger CarStatus enum direkte) -->
    <div class="filter-group">
      <select id="statusFilter" name="status"> <!-- 'name' for @RequestParam -->
        <option value="">Status</option>
        <!-- Antager 'availableStatuses' er et array af CarStatus enum konstanter -->
        <option th:each="stat : ${availableStatuses}"
                th:value="${stat.name()}"   <!-- Sender enum navnet (f.eks. "AVAILABLE") -->
        th:text="${stat.name()}">   <!-- Viser enum navnet -->
        </option>
      </select>
    </div>

    <!-- Model Filter -->
    <div class="filter-group">
      <select id="modelFilter" name="model"> <!-- 'name' for @RequestParam -->
        <option value="">Model</option>
        <!-- Antager 'availableModels' er en liste af Model DTO/Model objekter -->
        <!-- Hvert 'modelObj' bør have modelId, modelName, og evt. brandName -->
        <option th:each="modelObj : ${availableModels}"
                th:value="${modelObj.modelId}"
                th:text="${modelObj.brandName != null ? modelObj.brandName + ' ' + modelObj.modelName : modelObj.modelName}">
        </option>
      </select>
    </div>

    <!-- Fuel Type Filter -->
    <div class="filter-group">
      <select id="fuelTypeFilter" name="fuelType"> <!-- 'name' for @RequestParam -->
        <option value="">Fuel Type</option>
        <!-- Antager 'availableFuelTypes' er en liste af FuelType DTO/Model objekter -->
        <option th:each="fuel : ${availableFuelTypes}"
                th:value="${fuel.fuelTypeId}"
                th:text="${fuel.fuelTypeName}">
        </option>
      </select>
    </div>

    <!-- Transmission Type Filter -->
    <div class="filter-group">
      <select id="transmissionTypeFilter" name="transmissionType"> <!-- 'name' for @RequestParam -->
        <option value="">Transmission Type</option>
        <!-- Antager 'availableTransmissionTypes' er en liste af TransmissionType DTO/Model objekter -->
        <option th:each="trans : ${availableTransmissionTypes}"
                th:value="${trans.transmissionTypeId}"
                th:text="${trans.transmissionTypeName}">
        </option>
      </select>
    </div>

    <div class="filter-button-group">
      <button type="submit" class="btn-soeg-filter">Søg</button>
      <!-- Vis Alle peger nu på FleetController -->
      <a th:href="@{/fleet/overview}" class="btn btn-vis-alle">Vis Alle</a>
    </div>
  </form>

  <table class="car-table">
    <thead>
    <tr>
      <th>ID nummer</th>
      <th>Brand</th>
      <th>Model</th>
      <th>Status</th>
      <th>Fuel Type</th>
      <th>Transmission</th>
      <th>Detaljer</th>
    </tr>
    </thead>
    <tbody>
    <tr th:if="${#lists.isEmpty(cars)}">
      <td colspan="7" style="text-align: center;">Ingen biler fundet.</td> <!-- Opdateret colspan -->
    </tr>
    <tr th:unless="${#lists.isEmpty(cars)}" th:each="car : ${cars}">
      <td th:text="${car.carId}">0</td>
      <td th:text="${car.brandName}">N/A</td>
      <td th:text="${car.modelName}">N/A</td>
      <td th:text="${car.carStatusName}">N/A</td>
      <td th:text="${car.fuelTypeName}">N/A</td>
      <td th:text="${car.transmissionTypeName}">N/A</td>
      <td>
        <!-- Detaljer knap peger nu på FleetController -->
        <button type="button" class="btn-detaljer"
                th:attr="onclick=|location.href='@{/fleet/details/{id}(id=${car.carId})}'|">
          Detaljer
        </button>
      </td>
    </tr>
    </tbody>
  </table>
</div>

</body>
</html>
